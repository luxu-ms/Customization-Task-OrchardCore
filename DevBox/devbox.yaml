name: devbox-customization
image: MicrosoftVisualStudio_visualstudioplustools_vs-2022-ent-general-win11-m365-gen2
hostInformation: general_i_8c32gb256ssd_v2
supportsHibernation: true
setupTasks:
  - task: powershell
    inputs:
      command: |
        # Create a temparary folder to store source code
        New-Item -ItemType Directory -Path "C:\temp" -Force
        Set-Location "C:\temp"

        # Clone source code
        git clone https://github.com/OrchardCMS/OrchardCore.git

        # Install .NET 8 SDK
        winget install --id=Microsoft.DotNet.SDK.Preview -e --silent --accept-package-agreements --accept-source-agreements

        # Build and run OrchardCore
        Set-Location "C:\temp\OrchardCore\src\OrchardCore.Cms.Web"
        dotnet build 
        
        Write-host "Please wait several minutes for the first time to build the project. Then visist http://localhost:5000."
        dotnet run --framework net8.0
      runAsUser: true
